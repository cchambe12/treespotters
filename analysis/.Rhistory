labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
dist.p
View(dist)
read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Number of False Springs") +
ggtitle("") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
dist$group<-as.character(dist$group)
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Number of False Springs") +
ggtitle("") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
#coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
#write.csv(nao, file="naopredict.csv", row.names=FALSE)
#nao<-read.csv("~/Documents/git/regionalrisk/analyses/output/naopredict.csv", header=TRUE)
#nao$group<-as.character(nao$group)
nao.p<- ggplot(nao, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("NAO") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#write.csv(elev, file="elevpredict.csv", row.names=FALSE)
#elev<-read.csv("~/Documents/git/regionalrisk/analyses/output/elevpredict.csv", header=TRUE)
#elev$group<-as.character(elev$group)
elev.p<- ggplot(elev, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Elevation") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#write.csv(mat, file="~/Documents/git/regionalrisk/analyses/output/matpredict.csv", row.names=FALSE)
#mat<-read.csv("~/Documents/git/regionalrisk/analyses/output/matpredict.csv", header=TRUE)
#mat$group<-as.character(mat$group)
mat.p<- ggplot(mat, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Mean Spring Temperature") +
ylab("Number of False Springs") + ggtitle("") + theme_classic() + theme(legend.position = "none") +
#scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
#write.csv(dist, file="~/Documents/git/regionalrisk/analyses/output/distpredict.csv", row.names=FALSE)
#dist<-read.csv("~/Documents/git/regionalrisk/analyses/output/distpredict.csv", header=TRUE)
#dist$group<-as.character(dist$group)
dist.p<- ggplot(dist, aes(x=x, y=predicted, col=group)) + geom_line(aes(col=group)) + xlab("Distance from Coast") + ylab("Number of False Springs") +
ggtitle("") + theme_classic() + #scale_y_continuous(expand = c(0, 0)) +
coord_cartesian(ylim=c(0,0.4)) +
scale_color_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016")) +
scale_fill_manual(name="Climate Change", values=colz,
labels=c("-0.459208492649012"="1950-1983",
"0.544414297170614"="1984-2016"))
ggarrange(nao.p, elev.p, mat.p, dist.p, ncol=2, nrow=2)
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_bernsnewdvr.Rdata")
bernsnewdvr
summary(bernsnewdvr)
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_berndvrshort.Rdata")
berndvrshort
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_berndvrbigpriors.Rdata")
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/elevdist_bernoldbigpriors.Rdata")
library(rstanarm)
library(brms)
bernoldbigpriors
berndvrbigpriors
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/lat_cen.Rdata")
lat.cen
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_original.csv", header=TRUE)
table(bb$fs)
table(bb$fs, bb$species)
dselect<-read.csv("~/Documents/git/regionalrisk/memselect_orig.csv", header=TRUE)
dx<-cbind(bbs, dselect)
bb<-read.csv("/n/wolkovich_lab/Lab/Cat/fs_allspp_orig_allpred.csv", header=TRUE)
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_orig_allpred.csv", header=TRUE)
bb$lat.long<-paste(bb$lat, bb$long)
bb$Y<-ave(bb$fs.count, bb$lat.long, FUN=sum)
bbs<-bb[!duplicated(bb$lat.long),]
dx<-cbind(bbs, dselect)
library(dplyr)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -PEP_ID, -fs, -year)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -fs, -year)
colnames(bb)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -lat.long, -distance, -year)
rex.mod<-lm(fs.count~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
bb<-bb%>%dplyr::select(-eigen)
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig, by="lat.long")
head(prep_space)
range(eigen)
table(prep_space$eigen)
write.csv(prep_space, file="~/Documents/git/regionalrisk/analyses/output/fs_space_orig.csv", row.names=FALSE)
colnames(prep_space)
table(prep_space$fs.count, prep_space$species)
dselect<-read.csv("~/Documents/git/regionalrisk/analyses/output/memselect_orig.csv", header=TRUE)
dx<-cbind(bbs, dselect)
bb<-read.csv("/n/wolkovich_lab/Lab/Cat/fs_allspp_dvr_allpred.csv", header=TRUE)
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_dvr_allpred.csv", header=TRUE)
bb$lat.long<-paste(bb$lat, bb$long)
bb$Y<-ave(bb$fs.count, bb$lat.long, FUN=sum)
bbs<-bb[!duplicated(bb$lat.long),]
dx<-cbind(bbs, dselect)
load("/Users/CatherineChamberlain/Documents/git/regionalrisk/orig_bigpriors.Rdata")
orig.bigpriors
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_orig_allpred.csv", header=TRUE)
bb$lat.long<-paste(bb$lat, bb$long)
bb$Y<-ave(bb$fs.count, bb$lat.long, FUN=sum)
bbs<-bb[!duplicated(bb$lat.long),]
dselect<-read.csv("~/Documents/git/regionalrisk/analyses/output/memselect_orig.csv", header=TRUE)
dx<-cbind(bbs, dselect)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -lat.long, -distance, -year)
library(dplyr)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -lat.long, -distance, -year)
rex.mod<-lm(fs.count~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig, by="lat.long")
View(prep_space)
check<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_space_new.csv", header=TRUE)
range(check$eigen)
range(prep_space$eigen)
dselect<-read.csv("~/Documents/git/regionalrisk/analyses/output/memselect_orig.csv", header=TRUE)
colnames(dselect)
colnames(dx)
dx<-cbind(bbs, dselect)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -lat.long, -distance, -year, -fs.count, -nao, -cc)
rex.mod<-lm(Y~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig, by="lat.long")
range(prep_space$eigen)
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_space_orig.csv", header=TRUE)
#bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_space_orig.csv", header=TRUE)
bb<-subset(bb, select=c("species", "lat", "elev", "year", "mst", "cc", "fs.count", "nao",
"distkm", "eigen"))
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$nao.z <- (bb$nao-mean(bb$nao,na.rm=TRUE))/(2*sd(bb$nao,na.rm=TRUE))
bb$mat.z <- (bb$mst-mean(bb$mst,na.rm=TRUE))/(2*sd(bb$mst,na.rm=TRUE))
bb$cc.z <- (bb$cc-mean(bb$cc,na.rm=TRUE))/(2*sd(bb$cc,na.rm=TRUE))
bb$elev.z <- (bb$elev-mean(bb$elev,na.rm=TRUE))/(2*sd(bb$elev,na.rm=TRUE))
bb$lat.z <- (bb$lat-mean(bb$lat,na.rm=TRUE))/(2*sd(bb$lat,na.rm=TRUE))
bb$dist.z <-(bb$distkm-mean(bb$distkm,na.rm=TRUE))/(2*sd(bb$distkm,na.rm=TRUE))
bb$space.z <-(bb$eigen-mean(bb$eigen,na.rm=TRUE))/(2*sd(bb$eigen,na.rm=TRUE))
bb<-read.csv("~/Documents/git/regionalrisk/analyses/fs_space_orig.csv", header=TRUE)
bb<-read.csv("~/Documents/git/regionalrisk/fs_space_orig.csv", header=TRUE)
#bb<-read.csv("~/Documents/git/regionalrisk/fs_space_orig.csv", header=TRUE)
bb<-subset(bb, select=c("species", "lat", "elev", "year", "mst", "cc", "fs.count", "nao",
"distkm", "eigen"))
colnames(bb)
#dselect<-read.csv("~/Documents/git/regionalrisk/analyses/output/memselect_orig.csv", header=TRUE)
deselect<-bb
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_orig_allpred.csv", header=TRUE)
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$lat.long<-paste(bb$lat, bb$long)
bb$Y<-ave(bb$fs, bb$lat.long, FUN=sum)
bbs<-bb[!duplicated(bb$lat.long),]
dx<-cbind(bbs, dselect)
library(dplyr)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -lat.long, -distance, -year, -fs.count, -nao, -cc, -fs)
rex.mod<-lm(Y~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig, by="lat.long")
#write.csv(prep_space, file="~/Documents/git/regionalrisk/analyses/output/fs_space_dvr.csv", row.names=FALSE)
write.csv(dx, file="/n/wolkovich_lab/Lab/Cat/fs_space_orig.csv", row.names=FALSE)
#write.csv(prep_space, file="~/Documents/git/regionalrisk/analyses/output/fs_space_dvr.csv", row.names=FALSE)
write.csv(prep_space, file="/n/wolkovich_lab/Lab/Cat/fs_space_orig.csv", row.names=FALSE)
write.csv(prep_space, file="~/Documents/git/regionalrisk/analyses/output/fs_space_orig.csv", row.names=FALSE)
range(prep_space$eigen)
bb<-read.csv("~/Documents/git/regionalrisk/fs_space_dvr.csv", header=TRUE)
#bb<-read.csv("~/Documents/git/regionalrisk/fs_space_dvr.csv", header=TRUE)
bb<-subset(bb, select=c("species", "lat", "elev", "year", "mst", "cc", "fs.count", "nao",
"distkm", "eigen"))
dselect<-read.csv("~/Documents/git/regionalrisk/memselect_dvr.csv", header=TRUE)
dselect<-read.csv("~/Documents/git/regionalrisk/analyses/scripts/memselect_dvr.csv", header=TRUE)
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_dvr_allpred.csv", header=TRUE)
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$lat.long<-paste(bb$lat, bb$long)
bb$Y<-ave(bb$fs, bb$lat.long, FUN=sum)
bbs<-bb[!duplicated(bb$lat.long),]
#dselect<-read.csv("~/Documents/git/regionalrisk/analyses/scripts/memselect_dvr.csv", header=TRUE)
#deselect<-bb
dx<-cbind(bbs, dselect)
library(dplyr)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -lat.long, -distance, -year, -fs.count, -nao, -cc, -fs)
rex.mod<-lm(Y~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig, by="lat.long")
write.csv(prep_space, file="~/Documents/git/regionalrisk/analyses/output/fs_space_dvr.csv", row.names=FALSE)
range(prep_space$eigen)
bb<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_orig_allpred.csv", header=TRUE)
foo<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_space_dvr.csv", header=TRUE)
x<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_space_orig.csv", header=TRUE)
write.csv(dselect, file="/n/wolkovich_lab/Lab/Cat/memselect_orig.csv", row.names=FALSE)
dselect<-read.csv("~/Documents/git/regionalrisk/analyses/scripts/memselect_orig.csv", header=TRUE)
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$lat.long<-paste(bb$lat, bb$long)
bb$Y<-ave(bb$fs, bb$lat.long, FUN=sum)
bbs<-bb[!duplicated(bb$lat.long),]
#dselect<-read.csv("~/Documents/git/regionalrisk/analyses/scripts/memselect_orig.csv", header=TRUE)
#deselect<-bb
dx<-cbind(bbs, dselect)
library(dplyr)
rex<-dx%>%dplyr::select(-lat.long, -lat, -long, -species, -lat.long, -distance, -year, -fs.count, -nao, -cc, -fs)
rex.mod<-lm(Y~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig, by="lat.long")
range(prep_space$eigen)
range(x$eigen)
write.csv(prep_space, file="~/Documents/git/regionalrisk/analyses/output/fs_space_orig.csv", row.names=FALSE)
x<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_orig_allpred.csv", header=TRUE)
bb<-x
#bb<-x
#bb$fs<-ifelse(bb$fs.count>0, 1, 0)
#bb$lat.long<-paste(bb$lat, bb$long)
#bb$Y<-ave(bb$fs, bb$lat.long, FUN=sum)
#bbs<-bb%>%dplyr::select(lat.long, Y, elev, distkm, lat, long, fs.count)
#bbs$fs.count<-ave(bb$fs, bb$lat.long)
bbs<-bb[!duplicated(bb$lat.long),]
dselect<-read.csv("~/Documents/git/regionalrisk/analyses/scripts/memselect_orig.csv", header=TRUE)
dx<-cbind(bbs, dselect)
colnames(dx)
#eigen<-rowMeans(dx[,13:493])
dx$eigen<-dx[,13]
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, dx)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig)
bb<-prep_space
library(dplyr)
prep_space<-full_join(bb, beig)
bb<-prep_space
#bb$eigen<-rowMeans(bb[,20:24])
bb<-subset(bb, select=c("species", "lat", "elev", "year", "mst", "cc", "fs.count", "nao",
"distkm", "eigen"))
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$nao.z <- (bb$nao-mean(bb$nao,na.rm=TRUE))/(2*sd(bb$nao,na.rm=TRUE))
bb$mat.z <- (bb$mst-mean(bb$mst,na.rm=TRUE))/(2*sd(bb$mst,na.rm=TRUE))
bb$cc.z <- (bb$cc-mean(bb$cc,na.rm=TRUE))/(2*sd(bb$cc,na.rm=TRUE))
bb$elev.z <- (bb$elev-mean(bb$elev,na.rm=TRUE))/(2*sd(bb$elev,na.rm=TRUE))
#bb$lat.z <- (bb$lat-mean(bb$lat,na.rm=TRUE))/(2*sd(bb$lat,na.rm=TRUE))
bb$dist.z <-(bb$distkm-mean(bb$distkm,na.rm=TRUE))/(2*sd(bb$distkm,na.rm=TRUE))
bb$space.z <-(bb$eigen-mean(bb$eigen,na.rm=TRUE))/(2*sd(bb$eigen,na.rm=TRUE))
bb$space2.z <-(bb$eigen2-mean(bb$eigen2,na.rm=TRUE))/(2*sd(bb$eigen2,na.rm=TRUE))
norm.first<-glm(fs~ nao.z + mat.z + dist.z + elev.z + space.z +
cc.z + species + nao.z:species +
mat.z:species + dist.z:species + elev.z:species + space.z:species +
cc.z:species +
nao.z:cc.z + mat.z:cc.z + dist.z:cc.z + elev.z:cc.z + space.z:cc.z,
data=bb, family=binomial())
summary(norm.first)
noncenspace.first<-glm(fs~ nao.z + mat.z + dist.z + elev.z + eigen +
cc.z + species + nao.z:species +
mat.z:species + dist.z:species + elev.z:species + cc.z:species + eigen:species +
nao.z:cc.z + mat.z:cc.z + dist.z:cc.z + elev.z:cc.z + eigen:cc.z,
data=bb, family=binomial())
summary(noncenspace.first)
write.csv(prep_space, file="~/Documents/git/regionalrisk/analyses/output/fs_space_orig.csv", row.names=FALSE)
x<-read.csv("~/Documents/git/regionalrisk/analyses/output/fs_allspp_dvr_allpred.csv", header=TRUE)
bb<-x
#bb<-x
#bb$fs<-ifelse(bb$fs.count>0, 1, 0)
#bb$lat.long<-paste(bb$lat, bb$long)
#bb$Y<-ave(bb$fs, bb$lat.long, FUN=sum)
#bbs<-bb%>%dplyr::select(lat.long, Y, elev, distkm, lat, long, fs.count)
#bbs$fs.count<-ave(bb$fs, bb$lat.long)
bbs<-bb[!duplicated(bb$lat.long),]
dselect<-read.csv("~/Documents/git/regionalrisk/memselect_dvr.csv", header=TRUE)
dx<-cbind(bbs, dselect)
rex<-dx%>%dplyr::select(-lat.long, -distance, -lat, -long, -cc, -species, -nao, -mst, -year)
#test<-full_join(bbs, MEM.select)
#test<-test%>%dplyr::select(-species, -lat.long, -distance)
rex.mod<-lm(fs.count~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, dx)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig)
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig)
bb<-prep_space
#bb$eigen<-rowMeans(bb[,20:24])
bb<-subset(bb, select=c("species", "lat", "elev", "year", "mst", "cc", "fs.count", "nao",
"distkm", "eigen"))
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$nao.z <- (bb$nao-mean(bb$nao,na.rm=TRUE))/(2*sd(bb$nao,na.rm=TRUE))
bb$mat.z <- (bb$mst-mean(bb$mst,na.rm=TRUE))/(2*sd(bb$mst,na.rm=TRUE))
bb$cc.z <- (bb$cc-mean(bb$cc,na.rm=TRUE))/(2*sd(bb$cc,na.rm=TRUE))
bb$elev.z <- (bb$elev-mean(bb$elev,na.rm=TRUE))/(2*sd(bb$elev,na.rm=TRUE))
#bb$lat.z <- (bb$lat-mean(bb$lat,na.rm=TRUE))/(2*sd(bb$lat,na.rm=TRUE))
bb$dist.z <-(bb$distkm-mean(bb$distkm,na.rm=TRUE))/(2*sd(bb$distkm,na.rm=TRUE))
bb$space.z <-(bb$eigen-mean(bb$eigen,na.rm=TRUE))/(2*sd(bb$eigen,na.rm=TRUE))
bb$space2.z <-(bb$eigen2-mean(bb$eigen2,na.rm=TRUE))/(2*sd(bb$eigen2,na.rm=TRUE))
norm.first<-glm(fs~ nao.z + mat.z + dist.z + elev.z + space.z +
cc.z + species + nao.z:species +
mat.z:species + dist.z:species + elev.z:species + space.z:species +
cc.z:species +
nao.z:cc.z + mat.z:cc.z + dist.z:cc.z + elev.z:cc.z + space.z:cc.z,
data=bb, family=binomial())
summary(norm.first)
bb<-x
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
#bb<-x
#bb$fs<-ifelse(bb$fs.count>0, 1, 0)
#bb$lat.long<-paste(bb$lat, bb$long)
#bb$Y<-ave(bb$fs, bb$lat.long, FUN=sum)
#bbs<-bb%>%dplyr::select(lat.long, Y, elev, distkm, lat, long, fs.count)
#bbs$fs.count<-ave(bb$fs, bb$lat.long)
bbs<-bb[!duplicated(bb$lat.long),]
dx<-cbind(bbs, dselect)
rex<-dx%>%dplyr::select(-lat.long, -distance, -lat, -long, -cc, -species, -nao, -mst, -year)
#test<-full_join(bbs, MEM.select)
#test<-test%>%dplyr::select(-species, -lat.long, -distance)
rex.mod<-lm(fs.count~ ., data=rex)
space<-residuals(rex.mod)
eigen<-space
#bb<-bb%>%dplyr::select(-eigen)
b_space<-cbind(bbs, eigen)
beig<-subset(b_space, select=c("lat.long", "eigen"))
prep_space<-full_join(bb, beig)
bb<-prep_space
#bb$eigen<-rowMeans(bb[,20:24])
bb<-subset(bb, select=c("species", "lat", "elev", "year", "mst", "cc", "fs.count", "nao",
"distkm", "eigen"))
bb$fs<-ifelse(bb$fs.count>0, 1, 0)
bb$nao.z <- (bb$nao-mean(bb$nao,na.rm=TRUE))/(2*sd(bb$nao,na.rm=TRUE))
bb$mat.z <- (bb$mst-mean(bb$mst,na.rm=TRUE))/(2*sd(bb$mst,na.rm=TRUE))
bb$cc.z <- (bb$cc-mean(bb$cc,na.rm=TRUE))/(2*sd(bb$cc,na.rm=TRUE))
bb$elev.z <- (bb$elev-mean(bb$elev,na.rm=TRUE))/(2*sd(bb$elev,na.rm=TRUE))
#bb$lat.z <- (bb$lat-mean(bb$lat,na.rm=TRUE))/(2*sd(bb$lat,na.rm=TRUE))
bb$dist.z <-(bb$distkm-mean(bb$distkm,na.rm=TRUE))/(2*sd(bb$distkm,na.rm=TRUE))
bb$space.z <-(bb$eigen-mean(bb$eigen,na.rm=TRUE))/(2*sd(bb$eigen,na.rm=TRUE))
norm.first<-glm(fs~ nao.z + mat.z + dist.z + elev.z + space.z +
cc.z + species + nao.z:species +
mat.z:species + dist.z:species + elev.z:species + space.z:species +
cc.z:species +
nao.z:cc.z + mat.z:cc.z + dist.z:cc.z + elev.z:cc.z + space.z:cc.z,
data=bb, family=binomial())
summary(norm.first)
rm(list=ls())
options(stringsAsFactors = FALSE)
## Load Libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(rstanarm)
library(brms)
library(rstan)
library(RColorBrewer)
# Set Working Directory
setwd("~/Documents/git/treespotters/analysis")
## Get all that data!
## Start with phenology data and clean
bb<-read.csv("output/cleaned_tree_allcues.csv", header=TRUE)
rm(list=ls())
options(stringsAsFactors = FALSE)
## Load Libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(rstanarm)
library(geosphere)
library(anytime)
library(weathermetrics)
library(measurements)
library(lubridate)
library(egg)
# Set Working Directory
setwd("~/Documents/git/treespotters/analysis")
## Get all that data!
## Start with phenology data and clean
bb<-read.csv("input/individual_phenometrics_data.csv", header=TRUE)
bb<-bb%>%
rename(lat=Latitude)%>%
rename(long=Longitude)%>%
rename(elev=Elevation_in_Meters)%>%
rename(year=First_Yes_Year)%>%
rename(month=First_Yes_Month)%>%
rename(day=First_Yes_Day)%>%
rename(doy=First_Yes_DOY)%>%
rename(numYs=Multiple_Observers)%>%
rename(photo=Daylength) %>%
rename(phase=Phenophase_Description)%>%
rename(ID=Individual_ID)
bb.pheno<-dplyr::select(bb, Genus, Species, Common_Name, phase, lat, long, elev, year, doy, numYs, photo, ID, AGDD)
bb.pheno$phase<-ifelse(bb.pheno$phase=="Breaking leaf buds", "budburst", bb.pheno$phase)
bb.pheno$phase<-ifelse(bb.pheno$phase=="Leaves", "leafout", bb.pheno$phase)
bb.pheno$phase<-ifelse(bb.pheno$phase=="Flowers or flower buds", "flowers", bb.pheno$phase)
bb.pheno$phase<-ifelse(bb.pheno$phase=="Falling leaves", "leaf drop", bb.pheno$phase)
### Now work on finding day of budburst, etc.
bb.pheno<-filter(bb.pheno, numYs>0)
stan.bb<-bb.pheno%>%
group_by(ID, phase, year) %>%
slice(which.min(doy))
stan.bb$m.doy<-ave(stan.bb$doy, stan.bb$phase, stan.bb$Genus, stan.bb$year)
stan.bb<-stan.bb[!duplicated(stan.bb),]
#stan.bb$photo<-stan.bb$photo/3600
#x<-paste(stan.bb$year, stan.bb$doy)
#stan.bb$date<-as.Date(strptime(x, format="%Y %j"))
stan.bb$photo<-as.numeric(geosphere::daylength(stan.bb$lat, stan.bb$doy))
### Clean observation error!
stan.bb$doy<-ifelse(stan.bb$Species=="alleghaniensis"&stan.bb$year==2016&stan.bb$doy==59, NA, stan.bb$doy)
stan.bb<-stan.bb[!is.na(stan.bb$doy),]
#### Now start building a small data frame with phenophase info then add in forcing, chilling and photo
colstokeep<-c("Genus", "Species", "ID","year", "phase","lat", "long", "elev", "doy")
bbx<-subset(stan.bb, select=colstokeep)
bbx<-bbx[!duplicated(bbx),]
bbx<-bbx%>%tidyr::spread(phase, doy)
bbx$budburst<-ave(bbx$budburst, bbx$ID, bbx$year, FUN=first)
bbx$leafout<-ave(bbx$leafout, bbx$ID, bbx$year, FUN=first)
bbx$flowers<-ave(bbx$flowers, bbx$ID, bbx$year, FUN=first)
bbx$fruits<-ave(bbx$Fruits, bbx$ID, bbx$year, FUN=first)
bbx$col.leaves<-ave(bbx$`Colored leaves`, bbx$ID, bbx$year, FUN=first)
bbx$leafdrop<-ave(bbx$`leaf drop`, bbx$ID, bbx$year, FUN=first)
bbx$last.obs<-ave(bbx$`leaf drop`, bbx$ID, bbx$year, FUN=last)
bbx$last.obs<-ifelse(is.na(bbx$last.obs), ave(bbx$col.leaves, bbx$ID, bbx$year, FUN=last), bbx$last.obs)
bbx$gdd.start<-46 # 15 February for each year - arbitrary, can change
write.csv(bbx, file="output/clean_alldata.csv", row.names=FALSE)
rm(list=ls())
options(stringsAsFactors = FALSE)
## Load Libraries
library(dplyr)
library(tidyr)
library(ggplot2)
library(rstanarm)
library(brms)
library(rstan)
library(RColorBrewer)
# Set Working Directory
setwd("~/Documents/git/treespotters/analysis")
##### Fall stuffs!
bb18<-read.csv("clean_alldata.csv", header=TRUE)
##### Fall stuffs!
bb18<-read.csv("output/clean_alldata.csv", header=TRUE)
bb18<-subset(bb, bb$year==2018)
bb18<-subset(bb18, bb$year==2018)
bb18<-subset(bb18, bb18$year==2018)
View(bb18)
bb18<-subset(bb18, select=c("Genus", "Species", "col.leaves", "leafdrop"))
bb18$spp<-paste(bb18$Genus, bb18$Species, sep=" ")
quartz()
box<-ggplot(bb18, aes(x=spp, y=col.leaves, fill=spp)) + geom_boxplot(aes(fill=as.factor(spp), col=as.factor(spp))) +
theme_classic() + scale_alpha_manual(name="Dataset", values=c(0.2, 1), labels=c("TreeSpotters", "Harvard Forest")) +
scale_y_continuous(expand = c(0, 0)) + #coord_cartesian(ylim=c(80,135)) +
theme(text=element_text(family="Helvetica"),legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
plot.margin = unit(c(1.5,1.5,1.0,1.5), "lines"), axis.title.x = element_blank(), legend.position = "none",
axis.ticks.x = element_blank()) + ylab("Duration of Vegetative Risk")
box
box<-ggplot(bb18, aes(x=spp, y=leafdrop, fill=spp)) + geom_boxplot(aes(fill=as.factor(spp), col=as.factor(spp))) +
theme_classic() + scale_alpha_manual(name="Dataset", values=c(0.2, 1), labels=c("TreeSpotters", "Harvard Forest")) +
scale_y_continuous(expand = c(0, 0)) + #coord_cartesian(ylim=c(80,135)) +
theme(text=element_text(family="Helvetica"),legend.text.align = 0, axis.text.x = element_text(face = "italic", angle=45, hjust=1),
plot.margin = unit(c(1.5,1.5,1.0,1.5), "lines"), axis.title.x = element_blank(), legend.position = "none",
axis.ticks.x = element_blank()) + ylab("Duration of Vegetative Risk")
box
